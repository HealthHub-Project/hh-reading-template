<script src="../ag-grid/dist/ag-grid.js"></script>
<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../vaadin-icons/vaadin-icons.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-checkbox/paper-checkbox.html">
<link rel="import" href="../ag-grid-polymer/ag-grid-polymer.html">

<dom-module id="hh-reading-template">
    <template>
        <link rel="stylesheet" href="../bower_components/ag-grid/dist/styles/ag-grid.css">
        <link rel="stylesheet" href="../bower_components/ag-grid/dist/styles/ag-theme-balham-dark.css">
        <style>
            :host {
                display: block;
                height: 100%;
                width: 100%;
            }

            ag-grid-polymer {
                width: 100%;
                height: 100%;
            }

            .container {
                height: 100%;
                width: 100%;
            }

            .context {
                padding: 5px;
                height: calc(100% - 10px);
                width: calc(100% - 10px);
            }

            .template-configure {
                display: flex;
                height: 75px;
            }

            .template-configure-sensitive {
                width: 75%;
                margin-right: 5%;
            }

            .template-list {
                height: calc(100% - 75px);
            }

            .template-configure-setting-btn {
                width: 25%;
            }

            .class-sensitiveCheck{
                font-size: 13px;
                color: #aaaaaa;
            }

            .checkBox-style{
                font-size: 13px;
                color: #aaaaaa;
                --paper-checkbox-checked-color: #0087cb;
                --paper-checkbox-label-color: #aaaaaa;
                --paper-checkbox-unchecked-color: #4c5667;
                padding: 3px;
            }

            .icon-style {
                color: #aaaaaa;
                height: 25px;
                width: 25px;
                padding: 5px;
            }

        </style>
        <div class="container">
            <div class="context">
                <div class="template-configure">
                    <div class="template-configure-sensitive">
                        <div class="class-sensitiveCheck">
                            <paper-checkbox id="modality" class="checkBox-style" noink>Modality Sensitive</paper-checkbox>
                            <paper-checkbox id="bodypart" class="checkBox-style" noink>Bodypart Sensitive</paper-checkbox>
                            <paper-checkbox id="studyDescription" class="checkBox-style" noink>Study description Sensitive</paper-checkbox>
                        </div>
                    </div>
                    <div class="template-configure-setting-btn">
                        <iron-icon icon="vaadin:line-v" style="color: #aaaaaa; height: 15px; width: 15px"></iron-icon>
                        <paper-icon-button id="newTemplateBtn" icon="vaadin:plus-circle" class="icon-style">
                        </paper-icon-button>
                        <paper-icon-button id="settingBtn" icon="vaadin:vaadin:cog" class="icon-style">
                        </paper-icon-button>
                        <iron-icon icon="vaadin:line-v" style="color: #aaaaaa; height: 15px; width: 15px"></iron-icon>
                        <paper-icon-button id="importBtn" icon="vaadin:cloud-upload" class="icon-style">
                        </paper-icon-button>
                        <paper-icon-button id="exportBtn" icon="vaadin:cloud-download" class="icon-style">
                        </paper-icon-button>
                    </div>
                </div>
                <div class="template-list">
                    <ag-grid-polymer
                            class="ag-theme-balham-dark"
                            rowData="{{rowData}}" ,
                            columnDefs="{{columnDefs}}"
                            on-first-data-rendered="{{firstDataRendered}}"
                    ></ag-grid-polymer>
                </div>
            </div>
        </div>
    </template>
    <script>
        (function () {
            let _this;
            let _sensitiveCheckList = [false,false,false];

            class HhReadingTemplate extends Polymer.Element {
                static get is() {
                    return 'hh-reading-template';
                }

                ready() {
                    super.ready();
                    this.$.modality.addEventListener('change',function(e){
                        _sensitiveCheckList[0] = _this.$.modality.active;
                    });
                    this.$.bodypart.addEventListener('change',function(e){
                        _sensitiveCheckList[1] = _this.$.bodypart.active;
                    });
                    this.$.studyDescription.addEventListener('change',function(e){
                        _sensitiveCheckList[2] = _this.$.studyDescription.active;
                    });
                    this.$.newTemplateBtn.addEventListener('click', function (event) {
                        let popup = window.open("/bower_components/hh-reading-template/hh-reading-template-configure.html", "popup", "height=777, width=1700,resizable=yes,toolbar=no,status=0,location=no,menubar=no,scrollbars=0,dependent=yes");
                        // let popup = window.open("/hh-reading-template-configure.html", "popup", "height=777, width=1700, resizable=yes,toolbar=no,status=0,location=no,menubar=no,scrollbars=0,dependent=yes");
                        popup.struct = "popup test";
                    })
                    this.$.settingBtn.addEventListener('click', function (event) {
                        console.log("setting");
                    })
                    this.$.importBtn.addEventListener('click', function (event) {
                        console.log("importBtn");
                    })
                    this.$.exportBtn.addEventListener('click', function (event) {
                        console.log("exportBtn");
                    })
                }

                constructor() {
                    super();
                    _this = this;

                    this.gridOptions = {
                        defaultColDef: {
                            suppressMenu: true // 메뉴 막기
                        },
                        enableSorting: true,
                        enableColResize: true,
                        rowSelection: "single",
                        // getContextMenuItems: _this.getContextMenuItems(),
                        overlayNoRowsTemplate: '<span class="ag-overlay-no-rows-center">No records Found</span>',
                        toolPanelSuppressSideButtons: true,
                        toolPanelSuppressRowGroups: true,
                        toolPanelSuppressValues: true,
                        toolPanelSuppressColumnSelectAll: true,
                        toolPanelSuppressColumnExpandAll: true,
                        toolPanelSuppressColumnFilter: true,
                        toolPanelSuppressPivots: true,
                        toolPanelSuppressPivotMode: true
                    };

                    this.columnDefs = [
                        {headerName: "Title", field: "title", width: 100},
                        {headerName: "Shortcut", field: "shortcut", width: 90},
                        {headerName: "Modality", field: "modality", width: 100},
                        {headerName: "Bodypart", field: "bodypart", width: 100},
                        {headerName: "Study description", field: "studyDescription", width: 100},
                        {headerName: "Finding", field: "finding"},
                        {headerName: "Conclusion", field: "conclusion"},
                        {headerName: "Recommendation", field: "recommendation"}
                    ];
                    this.rowData = [
                        {seqNo:"0", modality: "CT", bodypart: "CHEST", studyDescription: "TEST1", title: "TEST1 title", finding: "finding1", conclusion: "conclusion1", recommendation: "recommendation1", shortcut: "test1"},
                        {seqNo:"1", modality: "MR", bodypart: "CHEST", studyDescription: "TEST2", title: "TEST2 title", finding: "finding2", conclusion: "conclusion2", recommendation: "recommendation2", shortcut: "test2"},
                        {seqNo:"2", modality: "CR", bodypart: "CHEST", studyDescription: "TEST3", title: "TEST3 title", finding: "finding3", conclusion: "conclusion3", recommendation: "recommendation3", shortcut: "test3"},
                    ];


                    this.gridOptions.onGridReady = (params) => {
                        params.api.sizeColumnsToFit();
                        console.log("test");
                    }

                    this.gridOptions.onRowSelected = (e) => {
                        console.log(e);
                    };

                    this.gridOptions.onRowDoubleClicked = (event) => {
                        console.log("double");
                    }

                }

            }

            window.customElements.define(HhReadingTemplate.is, HhReadingTemplate);
        })();
    </script>
</dom-module>
